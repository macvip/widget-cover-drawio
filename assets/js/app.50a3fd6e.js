(()=>{"use strict";var e={6009:(e,t,n)=>{var i=n(9963),a=(n(2801),n(6252)),o=n(2262),r=n(3577);const s={class:"circle-navigation"},l=["name"];function c(e,t,n,i,o,c){return(0,a.wg)(),(0,a.iD)("nav",s,[(0,a._)("button",{class:"circle-navigation__nav-btn",onClick:t[0]||(t[0]=(...e)=>c.toggleMenu&&c.toggleMenu(...e)),style:(0,r.j5)({backgroundImage:o.menu_btn.icon})},null,4),(0,a._)("ul",{class:"circle-navigation__list",onClick:t[1]||(t[1]=(...e)=>c.myClick&&c.myClick(...e))},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(o.menu_items,((e,t)=>((0,a.wg)(),(0,a.iD)("li",{class:"circle-navigation__item",key:e.name,style:(0,r.j5)({transform:e.position,transitionDelay:c.setURL[t].delay,opacity:o.isOpenMenu?.7:0})},[(0,a._)("div",{name:e.name,class:"circle-navigation__link",style:(0,r.j5)({backgroundImage:c.setURL[t].icon})},null,12,l)],4)))),128))])])}const{sin:u,cos:d,floor:m,PI:p}=Math,v={name:"CicleMenu",inject:["itemClicked"],data(){return{initialDistans:0,distanceBeforeItems:60,delayAnimation:30,isOpenMenu:!1,maxRadius:p,menu_btn:{name:"menu",icon:"url(images/toolbar/menu.png)"},menu_items:[{name:"Preview",icon:"preview.png",position:""},{name:"Refresh",icon:"refresh.png",position:""},{name:"Edit",icon:"edit.png",position:""},{name:"Save",icon:"png.png",position:""},{name:"Copy",icon:"copy.png",position:""}]}},methods:{toggleMenu(){this.isOpenMenu?this.initialDistans=0:this.initialDistans=this.distanceBeforeItems;let e=this.menu_items.length,t=this.maxRadius/e+18*p/360;this.menu_items=this.menu_items.map(((e,n)=>({...e,position:`translate(${m(u(n*t+p/2)*this.initialDistans)}px, ${m(d(n*t+p/2)*-this.initialDistans)}px)`}))),this.isOpenMenu=!this.isOpenMenu},myClick(e){this.itemClicked(e.target.getAttribute("name")),this.isOpenMenu=!1}},computed:{setURL(){return this.menu_items.map(((e,t)=>({...e,icon:`url(${"images/toolbar/"+e.icon})`,delay:t/this.delayAnimation+"s"})))}}};var g=n(3744);const w=(0,g.Z)(v,[["render",c],["__scopeId","data-v-c25520dc"]]),h=w;function f(e){if(window.clipboardData&&window.clipboardData.setData)return window.clipboardData.setData("Text",e);if(document.queryCommandSupported&&document.queryCommandSupported("copy")){var t=document.createElement("textarea");t.textContent=e,t.style.position="fixed",document.body.appendChild(t),t.select();try{return document.execCommand("copy")}catch(n){return console.warn("Copy to clipboard failed.",n),prompt("Copy to clipboard: Ctrl+C, Enter",e)}finally{document.body.removeChild(t)}}}var y=n(7398),b=n.n(y);const _=e=>((0,a.dD)("data-v-09b8b59a"),e=e(),(0,a.Cn)(),e),k={key:0,id:"content"},C={id:"toolmenu"},D={class:"imgFrame"},O=["src"],x={key:1,class:"newdraw"},S=_((()=>(0,a._)("img",{style:{width:"32px"},src:"images/sketch.png"},null,-1))),I=_((()=>(0,a._)("span",null," 新建绘图 ",-1))),j=[S,I],E=_((()=>(0,a._)("p",null,"在 Drawio 挂件中保存绘图后，请点击下方刷新按钮",-1))),M=_((()=>(0,a._)("img",{class:"btnIcon",src:"images/toolbar/refresh.png"},null,-1))),T=_((()=>(0,a._)("span",null,"刷新",-1))),R=[M,T],P={setup(e){const t=(0,o.iH)(null),n=(0,o.iH)(!0),i=(0,o.iH)(null),r=window.frameElement.parentElement.parentElement;t.value=r.getAttribute("data-node-id"),fetch("/api/attr/getBlockAttrs",{body:JSON.stringify({id:t.value}),method:"POST"}).then((e=>e.json())).then((e=>{let t=e.data["custom-data-assets"]||e.data["data-assets"];t&&(i.value=t),n.value=!1,l()}));var s=null;function l(){i.value&&(s&&clearTimeout(s),s=setTimeout((()=>{m(i.value)}),2e3))}function c(){window.open("/widgets/drawio/?id="+t.value,"_blank")}function u(){if(i.value){let e=document.querySelector("#svgImage");e.src="/"+i.value+"?t="+(new Date).getTime()}}function d(){window.location.reload()}function m(e){fetch("/api/attr/setBlockAttrs",{body:JSON.stringify({id:t.value,attrs:{"data-assets":e,"custom-data-assets":e}}),method:"POST"})}function p(){let e=document.querySelector("#svgImage").src;window.parent.document.previewDraw(e)}function v(){fetch("/"+i.value).then((e=>e.text())).then((e=>{var t=new Image;t.onload=()=>{const e=t.width,n=t.height,a=document.createElement("canvas");a.width=2*e,a.height=2*n,a.style.width=e+"px",a.style.height=n+"px";const o=a.getContext("2d");o.scale(2,2),o.drawImage(t,0,0);let r=a.toDataURL("image/png"),s=document.createElement("a");s.href=r;let l=i.value,c=l.substring("assets/".length,l.lastIndexOf("."));s.download=c,s.click()},t.src="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(e)))}))}function g(){let e=i.value.substring("assets/".length),t=`![${e}](${i.value})`;navigator.clipboard?navigator.clipboard.writeText(t):f(t)}function w(e){switch(e){case"Preview":p();break;case"Refresh":u();break;case"Edit":c();break;case"Save":v();break;case"Copy":g();break;default:break}}return window.addEventListener("resize",l,!1),(0,a.JJ)("itemClicked",w),(0,a.wF)((()=>{let e=window.parent.document;if(!e.getElementById("protyleViewerScript")){let t=e.createElement("script");t.id="protyleViewerScript",t.async=!0,t.src="/stage/protyle/js/viewerjs/viewer.js?v=1.10.4",e.head.appendChild(t)}if(!e.getElementById("previewdraw")){let t=e.createElement("script");t.id="previewdraw",t.innerHTML='\n            function previewDraw(src) {\n                let img = document.createElement("img");\n                img.src = src;\n                const pv = new Viewer(img,{\n                    button: false,\n                    hidden: function() {\n                        pv.destroy()\n                    },\n                    toolbar: {\n                        zoomIn: true,\n                        zoomOut: true,\n                        oneToOne: true,\n                        reset: true,\n                        prev: true,\n                        play: true,\n                        next: true,\n                        rotateLeft: true,\n                        rotateRight: true,\n                        flipHorizontal: true,\n                        flipVertical: true,\n                        close: function() {\n                            pv.destroy()\n                        }\n                    }\n                });\n                pv.show();\n            }\n            document.previewDraw = previewDraw;     \n        ',e.head.appendChild(t)}})),(e,t)=>((0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)((0,o.SU)(b()),{active:n.value,"onUpdate:active":t[0]||(t[0]=e=>n.value=e)},null,8,["active"]),n.value?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",k,[i.value?((0,a.wg)(),(0,a.iD)(a.HY,{key:0},[(0,a._)("div",C,[(0,a.Wm)((0,o.SU)(h))]),(0,a._)("div",D,[(0,a._)("img",{id:"svgImage",src:"/"+i.value},null,8,O)])],64)):((0,a.wg)(),(0,a.iD)("div",x,[(0,a._)("button",{class:"drawBtn",onClick:c},j),E,(0,a._)("button",{onClick:d},R)]))]))],64))}},H=(0,g.Z)(P,[["__scopeId","data-v-09b8b59a"]]),U=H,B=(0,i.ri)(U);B.mount("#app")}},t={};function n(i){var a=t[i];if(void 0!==a)return a.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,n),o.exports}n.m=e,(()=>{var e=[];n.O=(t,i,a,o)=>{if(!i){var r=1/0;for(u=0;u<e.length;u++){i=e[u][0],a=e[u][1],o=e[u][2];for(var s=!0,l=0;l<i.length;l++)(!1&o||r>=o)&&Object.keys(n.O).every((e=>n.O[e](i[l])))?i.splice(l--,1):(s=!1,o<r&&(r=o));if(s){e.splice(u--,1);var c=a();void 0!==c&&(t=c)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[i,a,o]}})(),(()=>{n.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return n.d(t,{a:t}),t}})(),(()=>{n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}})(),(()=>{n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{var e={143:0};n.O.j=t=>0===e[t];var t=(t,i)=>{var a,o,r=i[0],s=i[1],l=i[2],c=0;if(r.some((t=>0!==e[t]))){for(a in s)n.o(s,a)&&(n.m[a]=s[a]);if(l)var u=l(n)}for(t&&t(i);c<r.length;c++)o=r[c],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(u)},i=self["webpackChunkcover_drawio"]=self["webpackChunkcover_drawio"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var i=n.O(void 0,[998],(()=>n(6009)));i=n.O(i)})();